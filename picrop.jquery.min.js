(function(e){e.fn.Picrop=function(t){if(r[t]){return r[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return r.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.picrop")}};var t,n;var r={init:function(i){t=e.extend({fx:false,duration:400,loader:"loading",dirx:"center",diry:"center",onCrop:function(){}},i);n=e(this),pics=n.find("img");r.startHandle()},startHandle:function(){if(pics.length>0){pics.not(".crop").hide();n.addClass(t.loader);e(pics).each(function(){if(this.naturalWidth===0){var n=e(this).data("src"),i=e(this).data("fx");if(i===undefined){i=t.fx}if(!n){n=e(this).attr("src")}r.loadPictures(n,i,this)}else{r.crop(e(this),t.fx)}})}},loadPictures:function(t,n,i){i.onload=function(){r.crop(e(this),n)};i.src=t},crop:function(e,n){var i=e.parent(),s=e.width(),o=e.height(),u=i.width(),a=i.height(),f=o*u/s,l=s*a/o,c=0,h=0;var p=parseInt(e.data("duration"));if(f>=a){var c=(f-a)/2;e.width(u).height(f)}else if(l>=u){var h=(l-u)/2;e.height(a).width(l)}r.cropDirection(e,i,c,h);if(p===undefined||isNaN(p)){p=parseInt(t.duration)}i.removeClass(t.loader);if(n!==false){e.addClass("crop").fadeIn(p)}else{e.addClass("crop").show()}t.onCrop(e,i)},cropDirection:function(e,n,r,i){var s=e.data("dirx")!=undefined?e.data("dirx"):t.dirx,o=e.data("diry")!=undefined?e.data("diry"):t.diry;switch(s){case"center":i=i;break;case"left":i=0;break;case"right":i=e.width()-n.width();break;default:i=s;break}switch(o){case"center":r=r;break;case"top":r=0;break;case"bottom":r=e.height()-n.height();break;default:r=o;break}e.css("margin-top","-"+r+"px").css("margin-left","-"+i+"px")}}})(jQuery)